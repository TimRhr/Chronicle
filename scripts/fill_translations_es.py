#!/usr/bin/env python3
"""Fill Spanish translations for common UI strings."""


TRANSLATIONS = {
    # Auth & Login
    "Invalid credentials.": "Credenciales inválidas.",
    "You have been logged out.": "Has cerrado sesión.",
    "Please log in to view this page.": "Por favor, inicia sesión para ver esta página.",
    "Login": "Iniciar sesión",
    "Logout": "Cerrar sesión",
    "Register": "Registrarse",
    "Email": "Correo electrónico",
    "Password": "Contraseña",
    "Username": "Nombre de usuario",
    "Remember me": "Recordarme",
    "Forgot password?": "¿Olvidaste tu contraseña?",
    "Don't have an account?": "¿No tienes una cuenta?",
    "Already have an account?": "¿Ya tienes una cuenta?",
    "Create account": "Crear cuenta",
    "Sign in with Keycloak": "Iniciar sesión con Keycloak",
    "or": "o",

    # Navigation & UI
    "Loading...": "Cargando...",
    "No notifications": "No hay notificaciones",
    "Mark all as read": "Marcar todo como leído",
    "Notifications": "Notificaciones",
    "Show more": "Mostrar más",
    "Show less": "Mostrar menos",
    "more": "más",
    "Feed": "Feed",
    "Search": "Buscar",
    "Settings": "Ajustes",
    "My Profile": "Mi perfil",
    "Close": "Cerrar",
    "Cancel": "Cancelar",
    "Save": "Guardar",
    "Delete": "Eliminar",
    "Edit": "Editar",
    "Confirm": "Confirmar",
    "Back": "Atrás",
    "Next": "Siguiente",
    "Previous": "Anterior",
    "Yes": "Sí",
    "No": "No",
    "OK": "OK",
    "Try again": "Intentar de nuevo",

    # Posts
    "New Post": "Nueva publicación",
    "Create post": "Crear publicación",
    "Edit post": "Editar publicación",
    "Delete post": "Eliminar publicación",
    "Post": "Publicación",
    "Posts": "Publicaciones",
    "No posts yet": "Aún no hay publicaciones",
    "No posts found": "No se encontraron publicaciones",
    "No more posts": "No hay más publicaciones",
    "Create first post": "Crear la primera publicación",
    "No posts have been published yet.": "Aún no se ha publicado ninguna publicación.",
    "No posts match the selected filters.": "No hay publicaciones que coincidan con los filtros seleccionados.",
    "Reset filters": "Restablecer filtros",
    "edited": "editado",
    "Title": "Título",
    "Content": "Contenido",
    "Tags": "Etiquetas",
    "Publish": "Publicar",
    "Draft": "Borrador",
    "Published": "Publicado",
    "Scheduled": "Programado",
    "Schedule post": "Programar publicación",
    "Image": "Imagen",
    "Images": "Imágenes",
    "Upload image": "Subir imagen",
    "Remove image": "Eliminar imagen",

    # Comments
    "Comments": "Comentarios",
    "Write a comment...": "Escribe un comentario...",
    "Send": "Enviar",
    "Reply": "Responder",
    "No comments yet.": "Aún no hay comentarios.",
    "Delete comment": "Eliminar comentario",
    "older comments": "comentarios anteriores",
    "Show replies": "Mostrar respuestas",
    "Hide replies": "Ocultar respuestas",
    "reply": "respuesta",
    "replies": "respuestas",

    # Reactions & Interactions
    "Bookmark": "Marcador",
    "Bookmarked": "Marcado",
    "Bookmarks": "Marcadores",
    "React": "Reaccionar",
    "Click to change": "Haz clic para cambiar",
    "Remove reaction": "Eliminar reacción",
    "Please log in to react.": "Por favor, inicia sesión para reaccionar.",
    "to comment.": "para comentar.",

    # Groups
    "Groups": "Grupos",
    "Group": "Grupo",
    "Create group": "Crear grupo",
    "New group": "Nuevo grupo",
    "All groups": "Todos los grupos",
    "View all groups": "Ver todos los grupos",
    "No groups yet": "Aún no hay grupos",
    "You are not in any group yet.": "Aún no estás en ningún grupo.",
    "Create a group to share private posts with others.": "Crea un grupo para compartir publicaciones privadas con otros.",
    "Members": "Miembros",
    "Leave": "Salir",
    "Back to group": "Volver al grupo",
    "Group color": "Color del grupo",
    "Group icon": "Icono del grupo",
    "Description": "Descripción",
    "What is this group about?": "¿De qué trata este grupo?",
    "Share the first post in this group.": "Comparte la primera publicación en este grupo.",
    "Invite all": "Invitar a todos",
    "Remove member": "Eliminar miembro",
    "Remove": "Eliminar",
    "Delete group": "Eliminar grupo",
    "No users found": "No se encontraron usuarios",

    # Files
    "Files": "Archivos",
    "Upload file": "Subir archivo",
    "Upload": "Subir",
    "Download": "Descargar",
    "Delete file": "Eliminar archivo",
    "No files yet": "Aún no hay archivos",
    "Upload the first file to share it with the group.": "Sube el primer archivo para compartirlo con el grupo.",
    "Drag file here or": "Arrastra el archivo aquí o",
    "click to select": "haz clic para seleccionar",
    "Max. 50MB · Allowed:": "Máx. 50MB · Permitido:",
    "Short description of the file...": "Breve descripción del archivo...",
    "View": "Ver",

    # Announcements
    "Announcement": "Anuncio",
    "New announcement": "Nuevo anuncio",
    "Edit announcement": "Editar anuncio",
    "Create announcement": "Crear anuncio",
    "Delete announcement": "Eliminar anuncio",
    "Write your announcement... (Markdown is supported)": "Escribe tu anuncio... (se admite Markdown)",
    "Markdown is supported: **bold**, *italic*, [links](url), lists, etc.": "Se admite Markdown: **negrita**, *cursiva*, [enlaces](url), listas, etc.",
    "Border color": "Color del borde",
    "Preview": "Vista previa",
    "Preview appears here...": "La vista previa aparece aquí...",
    "Create": "Crear",

    # Pages
    "Pages": "Páginas",
    "Page": "Página",
    "Manage pages": "Gestionar páginas",
    "Create page": "Crear página",
    "Edit page": "Editar página",
    "Delete page": "Eliminar página",
    "No pages yet": "Aún no hay páginas",
    "Page title": "Título de la página",
    "Show in navigation": "Mostrar en la navegación",

    # Profile & Settings
    "Profile": "Perfil",
    "About me": "Sobre mí",
    "Bio": "Biografía",
    "Display name": "Nombre para mostrar",
    "Theme color": "Color del tema",
    "Text color": "Color del texto",
    "Font Family": "Familia de fuentes",
    "optional": "opcional",
    "Enable comments": "Habilitar comentarios",
    "Enable reactions": "Habilitar reacciones",
    "Organization": "Organización",

    # Search
    "Search posts...": "Buscar publicaciones...",
    "Search users...": "Buscar usuarios...",
    "No results": "Sin resultados",
    "No results found": "No se encontraron resultados",

    # Archive
    "Archive": "Archivo",
    "All Posts": "Todas las publicaciones",
    "No posts in archive": "No hay publicaciones en el archivo",

    # Tags
    "Manage tags": "Gestionar etiquetas",
    "Create tag": "Crear etiqueta",
    "No tags yet": "Aún no hay etiquetas",
    "Tag name": "Nombre de la etiqueta",
    "Color": "Color",
    "No trending tags": "No hay etiquetas en tendencia",

    # Errors
    "Error": "Error",
    "Error loading": "Error al cargar",
    "Error saving": "Error al guardar",
    "Error deleting": "Error al eliminar",
    "Something went wrong": "Algo salió mal",
    "Page not found": "Página no encontrada",
    "Server error": "Error del servidor",
    "Anonymous": "Anónimo",

    # File selection
    "Select file": "Seleccionar archivo",
    "No file selected": "Ningún archivo seleccionado",

    # Leave group
    "Do you really want to leave this group?": "¿Realmente quieres salir de este grupo?",

    # Layout styles
    "Grid": "Cuadrícula",
    "Masonry": "Mosaico",
    "Timeline": "Cronología",

    # Misc
    "Recent posts": "Publicaciones recientes",
    "Popular posts": "Publicaciones populares",
    "No posts": "Sin publicaciones",
    "Load more": "Cargar más",
    "Follow": "Seguir",
    "Unfollow": "Dejar de seguir",
    "Followers": "Seguidores",
    "Following": "Siguiendo",
    "List": "Lista",
    "Compact": "Compacto",
    "Cards": "Tarjetas",
    "Filter": "Filtro",
    "Sort": "Ordenar",
    "Date": "Fecha",
    "Author": "Autor",
    "From": "Desde",
    "To": "Hasta",
    "Apply": "Aplicar",
    "Clear": "Borrar",
    "Today": "Hoy",
    "Yesterday": "Ayer",
    "This week": "Esta semana",
    "This month": "Este mes",
    "This year": "Este año",

    # Confirmations & dialogs
    "Analytics admin is not configured. Please set ANALYTICS_ADMIN_PASSWORD in .env.": "El administrador de analíticas no está configurado. Por favor, establece ANALYTICS_ADMIN_PASSWORD en .env.",
    "Do you really want to delete this post? This action cannot be undone.": "¿Realmente quieres eliminar esta publicación? Esta acción no se puede deshacer.",
    "Do you really want to delete the page \"{title}\" and all related posts?": "¿Realmente quieres eliminar la página \"{title}\" y todas las publicaciones relacionadas?",
    "Do you really want to delete the page \\\"{title}\\\" and all related posts?": "¿Realmente quieres eliminar la página \\\"{title}\\\" y todas las publicaciones relacionadas?",
    "Do you really want to delete this file?": "¿Realmente quieres eliminar este archivo?",
    "Do you really want to delete this announcement? This action cannot be undone.": "¿Realmente quieres eliminar este anuncio? Esta acción no se puede deshacer.",
    "Do you really want to delete this comment? This action cannot be undone.": "¿Realmente quieres eliminar este comentario? Esta acción no se puede deshacer.",
    "Do you really want to invite all portal users to this group? This cannot be undone.": "¿Realmente quieres invitar a todos los usuarios del portal a este grupo? Esto no se puede deshacer.",
    "Do you really want to remove {name} from the group?": "¿Realmente quieres eliminar a {name} del grupo?",
    "Type the group name <b>{name}</b> to confirm deletion.": "Escribe el nombre del grupo <b>{name}</b> para confirmar la eliminación.",
    "Delete permanently": "Eliminar permanentemente",
    "Delete image": "Eliminar imagen",
    "Really delete image?": "¿Eliminar la imagen?",
    "Please select whether the post should appear on your profile or in a group.": "Por favor, selecciona si la publicación debe aparecer en tu perfil o en un grupo.",
    "Remove this image from the selection?": "¿Eliminar esta imagen de la selección?",

    # Post editor UI
    "+ Add poll": "+ Añadir encuesta",
    "− Hide poll": "− Ocultar encuesta",
    "+ Set time": "+ Establecer hora",
    "− Hide schedule": "− Ocultar programación",
    "Option 1": "Opción 1",
    "Option 2": "Opción 2",
    "Option {n}": "Opción {n}",
    "bold text": "texto en negrita",
    "italic text": "texto en cursiva",
    "strikethrough": "tachado",
    "Heading": "Encabezado",
    "Quote": "Cita",
    "code": "código",
    "List item": "Elemento de lista",
    "Link text": "Texto del enlace",
    "code here": "código aquí",
    "Error creating.": "Error al crear.",
    "Error creating tag.": "Error al crear la etiqueta.",
    "Show in menu": "Mostrar en el menú",
    "Delete tag": "Eliminar etiqueta",
    "Really delete tag?": "¿Eliminar la etiqueta?",
    "No preview available": "No hay vista previa disponible",
    "Please select a group.": "Por favor, selecciona un grupo.",

    # Auth validation
    "Registration is disabled.": "El registro está deshabilitado.",
    "Username must be at least 3 characters long.": "El nombre de usuario debe tener al menos 3 caracteres.",
    "Please enter a valid email address.": "Por favor, introduce una dirección de correo válida.",
    "Password must be at least 12 characters long.": "La contraseña debe tener al menos 12 caracteres.",
    "Password must contain at least one uppercase letter.": "La contraseña debe contener al menos una letra mayúscula.",
    "Password must contain at least one lowercase letter.": "La contraseña debe contener al menos una letra minúscula.",
    "Password must contain at least one number.": "La contraseña debe contener al menos un número.",
    "Password must contain at least one special character.": "La contraseña debe contener al menos un carácter especial.",
    "Passwords do not match.": "Las contraseñas no coinciden.",
    "Username is already taken.": "El nombre de usuario ya está en uso.",
    "Email address is already registered.": "La dirección de correo ya está registrada.",
    "Registration successful! You can now log in.": "¡Registro exitoso! Ya puedes iniciar sesión.",

    # Keycloak
    "Keycloak SSO is not enabled.": "El SSO de Keycloak no está habilitado.",
    "Error during Keycloak login.": "Error durante el inicio de sesión con Keycloak.",
    "Keycloak profile is incomplete (missing sub).": "El perfil de Keycloak está incompleto (falta sub).",
    "Keycloak profile has no email address. Please allow email in Keycloak.": "El perfil de Keycloak no tiene dirección de correo. Por favor, permite el correo en Keycloak.",
    "Keycloak registration was canceled. Please log in again.": "El registro de Keycloak fue cancelado. Por favor, inicia sesión de nuevo.",
    "This account is already linked to another login provider.": "Esta cuenta ya está vinculada a otro proveedor de inicio de sesión.",
    "Username may only contain letters, numbers and _ . -": "El nombre de usuario solo puede contener letras, números y _ . -",
    "This Keycloak account is already linked.": "Esta cuenta de Keycloak ya está vinculada.",
    "Keycloak registration canceled.": "Registro de Keycloak cancelado.",

    # Blog / pages / posts (server messages)
    "Profile updated successfully.": "Perfil actualizado correctamente.",
    "Title is required.": "El título es obligatorio.",
    "Page \"{title}\" was created.": "La página \"{title}\" se creó.",
    "Page \\\"{title}\\\" was created.": "La página \\\"{title}\\\" se creó.",
    "Page updated.": "Página actualizada.",
    "Page deleted.": "Página eliminada.",
    "Post created.": "Publicación creada.",
    "Post updated. {n} new images added.": "Publicación actualizada. Se añadieron {n} imágenes nuevas.",
    "Post updated.": "Publicación actualizada.",
    "Post deleted.": "Publicación eliminada.",

    # Notifications
    "{name} reacted with {emoji}": "{name} reaccionó con {emoji}",
    "{name} reacted with {emoji} to your comment": "{name} reaccionó con {emoji} a tu comentario",
    "{name} commented on your post": "{name} comentó tu publicación",
    "{name} replied to your comment": "{name} respondió a tu comentario",
    "{name} mentioned you in a comment": "{name} te mencionó en un comentario",
    "{name} is now following you": "{name} ahora te sigue",

    # Tags (server)
    "Tag name is required.": "El nombre de la etiqueta es obligatorio.",
    "A tag with this name already exists.": "Ya existe una etiqueta con este nombre.",
    "Tag created.": "Etiqueta creada.",
    "Tag deleted.": "Etiqueta eliminada.",

    # Polls (notifications)
    "New vote": "Nuevo voto",
    "{name} voted in your poll": "{name} votó en tu encuesta",

    # Groups (server)
    "Group name is required.": "El nombre del grupo es obligatorio.",
    "Group \"{name}\" created.": "Grupo \"{name}\" creado.",
    "Group \\\"{name}\\\" created.": "Grupo \\\"{name}\\\" creado.",
    "You are not a member of this group.": "No eres miembro de este grupo.",
    "Only admins can edit group settings.": "Solo los administradores pueden editar la configuración del grupo.",
    "Group settings saved.": "Configuración del grupo guardada.",
    "Only admins can delete groups.": "Solo los administradores pueden eliminar grupos.",
    "Group name does not match. Group was not deleted.": "El nombre del grupo no coincide. El grupo no fue eliminado.",
    "Group \"{name}\" was deleted.": "El grupo \"{name}\" fue eliminado.",
    "Group \\\"{name}\\\" was deleted.": "El grupo \\\"{name}\\\" fue eliminado.",
    "User not found.": "Usuario no encontrado.",
    "User is already a member.": "El usuario ya es miembro.",
    "{name} added you to the group \"{group}\"": "{name} te añadió al grupo \"{group}\"",
    "{name} added you to the group \\\"{group}\\\"": "{name} te añadió al grupo \\\"{group}\\\"",
    "{user} was added to the group.": "{user} fue añadido al grupo.",
    "Only admins can invite all users.": "Solo los administradores pueden invitar a todos los usuarios.",
    "{n} users were added to the group.": "Se añadieron {n} usuarios al grupo.",
    "You are the only admin. Transfer the admin role before leaving the group.": "Eres el único administrador. Transfiere el rol de administrador antes de salir del grupo.",
    "You left the group \"{name}\".": "Saliste del grupo \"{name}\".",
    "You left the group \\\"{name}\\\".": "Saliste del grupo \\\"{name}\\\".",
    "Only admins can remove members.": "Solo los administradores pueden eliminar miembros.",
    "You cannot remove yourself.": "No puedes eliminarte a ti mismo.",
    "Member removed.": "Miembro eliminado.",
    "Only admins can change roles.": "Solo los administradores pueden cambiar roles.",
    "You cannot change your own role.": "No puedes cambiar tu propio rol.",
    "{user} is now a regular member.": "{user} ahora es un miembro normal.",
    "{user} is now an admin.": "{user} ahora es administrador.",

    # Files (server)
    "No file selected.": "Ningún archivo seleccionado.",
    "File type not allowed. Allowed types: {types}": "Tipo de archivo no permitido. Tipos permitidos: {types}",
    "File is too large. Maximum size: 50MB": "El archivo es demasiado grande. Tamaño máximo: 50MB",
    "File \"{name}\" uploaded successfully.": "Archivo \"{name}\" subido correctamente.",
    "File \\\"{name}\\\" uploaded successfully.": "Archivo \\\"{name}\\\" subido correctamente.",
    "You do not have permission to delete this file.": "No tienes permiso para eliminar este archivo.",
    "File deleted.": "Archivo eliminado.",

    # Announcements (server)
    "Only group admins can create announcements.": "Solo los administradores del grupo pueden crear anuncios.",
    "Please enter content.": "Por favor, introduce contenido.",
    "Announcement created.": "Anuncio creado.",
    "Only group admins can edit announcements.": "Solo los administradores del grupo pueden editar anuncios.",
    "Announcement updated.": "Anuncio actualizado.",
    "Only group admins can delete announcements.": "Solo los administradores del grupo pueden eliminar anuncios.",
    "Announcement deleted.": "Anuncio eliminado.",

    # UI labels & pages
    "Language": "Idioma",
    "Toggle theme": "Cambiar tema",
    "Back to top": "Volver arriba",
    "Tag": "Etiqueta",
    "Reset": "Restablecer",
    "Active filters": "Filtros activos",
    "Remove all": "Eliminar todo",
    "Loading comments...": "Cargando comentarios...",
    "Trending tags": "Etiquetas de tendencia",
    "My Groups": "Mis grupos",
    "Quick actions": "Acciones rápidas",
    "New post": "Nueva publicación",
    "Edit profile": "Editar perfil",
    "Overview": "Resumen",
    "This user has not published any posts yet.": "Este usuario aún no ha publicado ninguna publicación.",
    "No posts on this page": "No hay publicaciones en esta página",
    "No posts have been published on this page yet.": "Aún no se han publicado publicaciones en esta página.",
    "Back to feed": "Volver al feed",
    "Confirm password": "Confirmar contraseña",
    "Are you sure?": "¿Estás seguro?",
    "Unpublished": "No publicado",
    "Statistics": "Estadísticas",
    "Back to groups": "Volver a grupos",
    "Create new group": "Crear nuevo grupo",
    "Group name": "Nombre del grupo",
    "Group settings": "Configuración del grupo",
    "Cover image": "Imagen de portada",
    "Upload cover image": "Subir imagen de portada",
    "Change icon": "Cambiar icono",
    "Upload icon": "Subir icono",
    "Save changes": "Guardar cambios",
    "Invite member": "Invitar miembro",
    "Search user...": "Buscar usuario...",
    "Invite": "Invitar",
    "Invite all portal users": "Invitar a todos los usuarios del portal",
    "Invites all registered users to this group": "Invita a todos los usuarios registrados a este grupo",
    "Remove admin role": "Quitar rol de administrador",
    "Make admin": "Hacer administrador",
    "This action deletes the group": "Esta acción elimina el grupo",
    "including posts, files and memberships. This cannot be undone.": "incluyendo publicaciones, archivos y membresías. Esto no se puede deshacer.",
    "Delete group permanently": "Eliminar grupo permanentemente",
    "All": "Todos",
    "Archive is empty": "El archivo está vacío",
    "Create your first post.": "Crea tu primera publicación.",
    "No bookmarks": "Sin marcadores",
    "Save interesting posts as bookmarks.": "Guarda publicaciones interesantes como marcadores.",
    "edit": "editar",
    "Bold (Ctrl+B)": "Negrita (Ctrl+B)",
    "Italic (Ctrl+I)": "Cursiva (Ctrl+I)",
    "Strikethrough": "Tachado",
    "Code": "Código",
    "Numbered list": "Lista numerada",
    "Insert link": "Insertar enlace",
    "Markdown is supported: **bold**, *italic*, `code`, > quote, - list. Links are automatically embedded as previews.": "Se admite Markdown: **negrita**, *cursiva*, `código`, > cita, - lista. Los enlaces se incrustan automáticamente como vistas previas.",
    "Where should the post appear?": "¿Dónde debe aparecer la publicación?",
    "On my profile": "En mi perfil",
    "In a group": "En un grupo",
    "No page (overview only)": "Sin página (solo resumen)",
    "Public (everyone can see)": "Público (todos pueden ver)",
    "Only group members can see this post.": "Solo los miembros del grupo pueden ver esta publicación.",
    "Search or create tag...": "Buscar o crear etiqueta...",
    "Schedule publication": "Programar publicación",
    "− Edit schedule": "− Editar programación",
    "The post will only be visible in the feed at the selected time.": "La publicación solo será visible en el feed a la hora seleccionada.",
    "Remove schedule": "Eliminar programación",
    "Existing images": "Imágenes existentes",
    "Drag & drop to reorder": "Arrastra y suelta para reordenar",
    "Add new images": "Añadir nuevas imágenes",
    "Select files": "Seleccionar archivos",
    "Hidden": "Oculto",
    "No pages yet.": "Aún no hay páginas.",
    "Title of your post": "Título de tu publicación",
    "What would you like to share?": "¿Qué te gustaría compartir?",
    "Poll": "Encuesta",
    "Poll question...": "Pregunta de la encuesta...",
    "+ Add option": "+ Añadir opción",
    "Multiple choice": "Opción múltiple",
    "Ends": "Finaliza",
    "Remove poll": "Eliminar encuesta",
    "Drag images here or click": "Arrastra imágenes aquí o haz clic",
    "PNG, JPG, GIF, WebP allowed": "Se permiten PNG, JPG, GIF, WebP",
    "Create a new post for this page.": "Crea una nueva publicación para esta página.",
    "Search term": "Término de búsqueda",
    "All tags": "Todas las etiquetas",
    "All pages": "Todas las páginas",
    "result": "resultado",
    "results": "resultados",
    "found": "encontrado(s)",
    "Try different search terms or filters.": "Prueba con otros términos de búsqueda o filtros.",
    "Profile settings": "Configuración del perfil",
    "Profile picture": "Foto de perfil",
    "Tell something about yourself...": "Cuéntanos algo sobre ti...",
    "Design & Colors": "Diseño y colores",
    "Accent color": "Color de acento",
    "Background color": "Color de fondo",
    "Enable": "Habilitar",
    "Font": "Fuente",
    "Default (Inter)": "Predeterminado (Inter)",
    "Serif (Georgia)": "Serif (Georgia)",
    "Monospace": "Monoespaciada",
    "Rounded (Nunito)": "Redondeada (Nunito)",
    "Layout": "Diseño",
    "Post layout": "Diseño de publicaciones",
    "Create new tag": "Crear nueva etiqueta",
    "Name": "Nombre",
    "Existing tags": "Etiquetas existentes",
    "No tags created yet.": "Aún no se han creado etiquetas.",
}


def fill_translations(po_file_path: str) -> int:
    """Fill empty translations in a .po file."""
    def unquote_po(line: str) -> str:
        s = line.strip()
        if not (s.startswith('"') and s.endswith('"')):
            return ''
        inner = s[1:-1]
        # Unescape common PO sequences so keys match the human-readable msgid
        # (e.g. \" -> ")
        inner = inner.replace('\\\\', '\\')
        inner = inner.replace('\\"', '"')
        inner = inner.replace('\\n', '\n')
        inner = inner.replace('\\t', '\t')
        inner = inner.replace('\\r', '\r')
        return inner

    def escape_po(s: str) -> str:
        return s.replace('\\', '\\\\').replace('"', '\\"')

    with open(po_file_path, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    filled_count = 0
    i = 0
    while i < len(lines):
        line = lines[i]
        if not line.startswith('msgid '):
            i += 1
            continue

        # Parse msgid (supports multiline msgid "" + quoted parts)
        msgid_parts = [unquote_po(line[len('msgid '):])]
        i += 1
        while i < len(lines) and lines[i].lstrip().startswith('"'):
            msgid_parts.append(unquote_po(lines[i]))
            i += 1
        msgid = ''.join(msgid_parts)

        # Parse msgstr
        if i >= len(lines) or not lines[i].startswith('msgstr '):
            continue

        msgstr_start = i
        msgstr_parts = [unquote_po(lines[i][len('msgstr '):])]
        i += 1
        while i < len(lines) and lines[i].lstrip().startswith('"'):
            msgstr_parts.append(unquote_po(lines[i]))
            i += 1
        msgstr = ''.join(msgstr_parts)

        if msgid and (msgstr.strip() == '') and (msgid in TRANSLATIONS):
            translation = TRANSLATIONS[msgid]
            new_line = f'msgstr "{escape_po(translation)}"\n'
            lines[msgstr_start:i] = [new_line]
            i = msgstr_start + 1
            filled_count += 1
            print(f"  ✓ {msgid} -> {translation}")

    with open(po_file_path, 'w', encoding='utf-8', newline='\n') as f:
        f.writelines(lines)

    return filled_count


if __name__ == '__main__':
    import sys

    po_file = sys.argv[1] if len(sys.argv) > 1 else 'src/translations/es/LC_MESSAGES/messages.po'
    print(f"Filling translations in {po_file}...")
    count = fill_translations(po_file)
    print(f"\nFilled {count} translations.\n")
